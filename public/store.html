
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="css/bootstrap-grid.css">
        <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
        <link rel="stylesheet" type="text/css" href="css/style.css">
         
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript" src="js/bootstrap.js"></script>  
        <script type="text/javascript" src="js/socket.js"></script>
        <script type="text/javascript" src="js/api.js"></script>
        
        <title>Best Seats</title>
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="col-lg-3" id="menubody">
                    <h1 id="header">Best Seats</h1>
                    <hr>
                    <button id="addtable" class="button">Add Table</button>
                    <button id="removetable" class="button">Remove Table</button>
                    <a href="index.html"><button id="storelogin" class="button">Log Out</button></a>
                </div> 
                <div id="rightbodycontainer">
                <div class="col-lg-9" id="rightbody">
                    
                    <script>
                        
                        var xpos;
                        var ypos;
                        var ID;
                         var passremove = false;
                        
                        $("#removetable").click(function(){
                            passremove = true;
                        });
                        function getTables() {
                            API.getTables(function(tables) {
                                $('.tableimg').remove();
                                tables.forEach(function(table) {
                                    xpos = table.x;
                                    ypos = table.y;
                                    ID = table.ID;

                            var element = $("<li class='tableimg' id='" + ID + "' width='100px'></li>");

                            element.appendTo("#rightbody");
                            element.css({

                                    "left" : (xpos - 50),
                                    "top" : (ypos - 50)
                                });

                            element.attr('id', ID);
                                    
                            element.click(function() {
                                if(passremove == true){
                                var ID = $(this).prop("id");
                                API.removeTable(parseInt(ID), function() {
                                    
                                    getTables();
                                })
                                }
                                passremove = false;
                            })
                            });
                                 });
                        }
                        getTables();
                    </script>
                    <script>
                        /*To remove have an onclick function for the class tableimg, use this. whatever and set display to hidden*/
                        var count = 0;
                        var region;
                        var passadd = false;
                        $("#addtable").click(function(){
                            passadd = true;
                            region = prompt("Enter Region ID:")
                            $("#rightbody").css({
                                    "cursor" : "url(img/tablecursor.png) 50 50, auto"
                                });
                        });
                        
                        $("#rightbody").click(function(event) {
                           $("#rightbody").css({
                                    "cursor" : "inherit"
                                });
                            if(passadd == true) {
                                
                                var elm = $("#rightbody");
                                var Xpos = event.pageX - elm.offset().left;
                                var Ypos = event.pageY - elm.offset().top;
                                count++;
                                var element = $("<li class='tableimg' id='0' onclick='tableremove' width='100px'></li>");
                                element.appendTo("#rightbody");
                                    element.css({
                                        "left" : (Xpos - 50),
                                        "top" : (Ypos - 50)
                                    });

                                    element.attr('id', count);
                                    API.addTable("Table " + count, region, Xpos, Ypos, function() {
                                        
                                        getTables();
                                    })
                            }
                            passadd = false
                            
                            return;
                        }); 
                                    
            </script>
            
                        
                    
                </div>
                </div>
            </div>
        </div>
    </body>
</html>